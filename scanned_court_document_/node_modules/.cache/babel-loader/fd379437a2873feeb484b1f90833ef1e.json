{"ast":null,"code":"'use strict';\n\nvar nodeUtil = require(\"util\"),\n    nodeEvents = require(\"events\"),\n    fs = require('fs'),\n    _ = require('underscore'),\n    DOMParser = require('xmldom').DOMParser,\n    PDFCanvas = require('./pdfcanvas.js'),\n    PDFUnit = require('./pdfunit.js'),\n    PDFField = require('./pdffield.js'),\n    PDFAnno = require('./pdfanno.js'),\n    Image = require('./pdfimage.js'),\n    pkInfo = require('../package.json');\n\nvar xmlData;\n\nvar PTIXmlParser = function () {\n  'use strict';\n\n  var ptiPageArray = []; // constructor\n\n  var cls = function cls() {};\n\n  cls.prototype.parseXml = function (filePath, callback) {\n    fs.readFile(filePath, 'utf8', function (err, data) {\n      if (err) {\n        callback(err);\n      } else {\n        xmlData = data;\n        var parser = new DOMParser();\n        var dom = parser.parseFromString(xmlData);\n        var root = dom.documentElement;\n        var xmlFields = root.getElementsByTagName(\"field\");\n        var fields = [];\n\n        for (var i = 0; i < xmlFields.length; i++) {\n          var id = xmlFields[i].getAttribute('id');\n          var xPos = xmlFields[i].getAttribute('x');\n          var yPos = xmlFields[i].getAttribute('y');\n          var width = xmlFields[i].getAttribute('width');\n          var height = xmlFields[i].getAttribute('height');\n          var type = xmlFields[i].getAttribute('xsi:type');\n          var page = xmlFields[i].getAttribute('page');\n          var fontName = xmlFields[i].getAttribute('fontName');\n          var fontSize = xmlFields[i].getAttribute('fontSize');\n          var item = {};\n          var rectLeft = parseInt(xPos) - 21; //was 23.5\n\n          var rectTop = parseInt(yPos) - 20; //was 23\n\n          var rectRight = parseInt(rectLeft) + parseInt(width) - 4;\n          var rectBottom = parseInt(rectTop) + parseInt(height) - 4;\n          item.fieldType = \"Tx\";\n\n          if (type == \"Boolean\") {\n            item.fieldType = \"Btn\";\n          } else if (type == \"SSN\" || type == \"Phone\" || type == \"zip\") {\n            item.TName = type.toLowerCase();\n          }\n\n          item.alternativeText = \"\";\n          item.fullName = id;\n          item.fontSize = fontSize;\n          item.subtype = \"Widget\";\n          item.rect = [rectLeft, rectTop, rectRight, rectBottom];\n          ;\n          fields.push(item);\n          ptiPageArray[parseInt(page)] = fields;\n        }\n      }\n\n      callback();\n    });\n  };\n\n  cls.prototype.getFields = function (pageNum) {\n    return ptiPageArray[pageNum];\n  };\n\n  return cls;\n}();\n\nmodule.exports = PTIXmlParser;","map":null,"metadata":{},"sourceType":"script"}